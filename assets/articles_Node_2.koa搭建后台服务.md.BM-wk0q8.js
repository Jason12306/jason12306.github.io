import{_ as a,c as i,o as n,a2 as t}from"./chunks/framework.CnKoBJ9A.js";const E=JSON.parse('{"title":"koa 搭建后台服务","description":"","frontmatter":{},"headers":[],"relativePath":"articles/Node/2.koa搭建后台服务.md","filePath":"articles/Node/2.koa搭建后台服务.md"}'),e={name:"articles/Node/2.koa搭建后台服务.md"};function l(h,s,p,k,r,o){return n(),i("div",null,s[0]||(s[0]=[t(`<h1 id="koa-搭建后台服务" tabindex="-1">koa 搭建后台服务 <a class="header-anchor" href="#koa-搭建后台服务" aria-label="Permalink to &quot;koa 搭建后台服务&quot;">​</a></h1><h2 id="全局异常处理" tabindex="-1">全局异常处理 <a class="header-anchor" href="#全局异常处理" aria-label="Permalink to &quot;全局异常处理&quot;">​</a></h2><p>在顶层使用中间件进行异常捕获并处理</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Koa </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;koa&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// exception-handler.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> exceptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Koa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Middleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> next</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // error instanceof xx</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ctx.body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;do something&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// app.ts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">exceptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><h2 id="日志处理-log4js" tabindex="-1">日志处理 log4js <a class="header-anchor" href="#日志处理-log4js" aria-label="Permalink to &quot;日志处理 log4js&quot;">​</a></h2><ul><li><a href="https://www.npmjs.com/package/log4js" target="_blank" rel="noreferrer">log4js</a></li><li><a href="https://juejin.cn/post/7134000588408225799" target="_blank" rel="noreferrer">参考文档</a></li></ul><h2 id="jwt-认证" tabindex="-1">JWT 认证 <a class="header-anchor" href="#jwt-认证" aria-label="Permalink to &quot;JWT 认证&quot;">​</a></h2><p><a href="https://www.npmjs.com/package/koa-jwt" target="_blank" rel="noreferrer">koa-jwt</a></p><h2 id="数据库与-orm" tabindex="-1">数据库与 ORM <a class="header-anchor" href="#数据库与-orm" aria-label="Permalink to &quot;数据库与 ORM&quot;">​</a></h2><ul><li><a href="https://www.npmjs.com/package/mysql2" target="_blank" rel="noreferrer">mysql2</a></li><li><a href="https://www.npmjs.com/package/typeorm" target="_blank" rel="noreferrer">typeorm</a></li></ul>`,10)]))}const g=a(e,[["render",l]]);export{E as __pageData,g as default};
